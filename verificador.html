<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Verificando tag...</title>
</head>
<body>
  <p>⏳ Verificando el tag. Por favor espera...</p>
  <script>
    const params = new URLSearchParams(window.location.search);
    const tag = params.get("tag");

    if (!tag) {
      document.body.innerHTML = "<p style='color:red;'>❌ No se especificó ningún tag.</p>";
    } else {
      fetch(`https://idgonow.up.railway.app/api/v2/tables/m340oj04ihz4wlu/records?where=tag,eq,${tag}`, {
        headers: { "xc-token": "HzyX5A2ycuqlDhV2uyiQ-12UhN_DM0uO4Bfxe7hy" }
      })
      .then(res => res.json())
      .then(data => {
        const records = data.records || data;
        if (Array.isArray(records) && records.length > 0) {
          window.location.href = `ficha.html?tag=${tag}`;
        } else {
          sessionStorage.setItem("tagPendiente", tag);
          window.location.href = `index.html`;
        }
      })
      .catch(err => {
        document.body.innerHTML = `<p style='color:red;'>❌ Error al verificar el tag: ${err.message}</p>`;
      });
    }
  </script>
</body>
</html>

